import os
import json
import argparse


def update_json_files(directory, status):
    # Validate status input
    if status not in ["benign", "malware"]:
        raise ValueError("Status must be 'benign' or 'malware'.")

    # Iterate through all files in the specified directory
    for filename in os.listdir(directory):
        if filename.endswith(".json"):
            file_path = os.path.join(directory, filename)

            # Read the existing JSON data
            with open(file_path, "r") as file:
                data = json.load(file)

            # Add the status field
            data["status"] = status

            # Write the updated JSON data back to the file
            with open(file_path, "w") as file:
                json.dump(data, file, indent=4)


if __name__ == "__main__":
    # Set up argument parsing
    parser = argparse.ArgumentParser(description="Update JSON files with status.")
    parser.add_argument(
        "directory", type=str, help="The directory containing JSON files."
    )
    parser.add_argument(
        "status",
        type=str,
        help='The status to add to the JSON files ("benign" or "malware").',
    )
    args = parser.parse_args()

    # Update the JSON files with the provided status
    update_json_files(args.directory, args.status)
