import json
import os

# List of directories containing the JSON files
directories = [
    "../formatted_data/malware/",
    "../formatted_data/benign/",
    # Add more directories as needed
]

# Set to hold unique feature names
feature_names = set()

# Iterate through each directory
for directory_path in directories:
    # Iterate through each file in the directory
    for filename in os.listdir(directory_path):
        if filename.endswith(".json"):
            file_path = os.path.join(directory_path, filename)

            # Read the JSON file
            with open(file_path, "r") as file:
                data = json.load(file)

            # Add feature names to the set
            feature_names.update(data.keys())

# Choose the output format: text file or JSON file

# Write the feature names to a text file
output_text_file_path = "../feature_names.txt"
with open(output_text_file_path, "w") as output_file:
    for feature in sorted(feature_names):
        output_file.write(f"{feature}\n")

print(f"Feature names list created at: {output_text_file_path}")
